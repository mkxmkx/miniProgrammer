## java虚拟机——线程安全
java语言中各种操作共享的数据分为以下5类：不可变、绝对线程安全、相对线程安全、线程兼容、线程对立

1、不可变：不可变的对象一定是线程安全的。不需要采取任何的线程安全保障措施。
2、绝对线程安全：不管运行环境如何，调用者都不需要任何额外的同步措施
3、相对线程安全：对该对象单独的操作是线程安全的，在调用时不需要额外的保障措施。对于伊特特定顺序的连续调用，在调用端使用额外的同步手段来保证调用的正确性。
4、线程兼容：对象本身并不是线程安全的，可以通过在调用端正确的使用同步手段来保证对象在并发环境中可以安全地使用。
5、线程对立：无论调用端是否采取了同步措施，都无法在多线程环境中并发使用的代码。

### 线程安全的实现方法
1、互斥同步
保证共享数据在一个时刻只被一个线程使用。
实现手段：临界区、互斥量（mutex），信号量（semaphore）

最基本的互斥同步手段是synchronized关键字。
java的线程是映射到操作系统的原生线程之上的，如果要阻塞或唤醒一个线程，都需要操作系统帮忙，就需要从用户转换到内核态，因此状态转换需要耗费很多的处理器时间。因此，synchronized是java的一个重量级操作。

2、非阻塞同步
互斥同步是阻塞同步，主要问题是进行线程阻塞和唤醒所带来的的性能问题。
非阻塞同步——基于冲突检测的乐观并发策略：先进行操作，如果没有其他线程争用共享数据，操作成功；如果共享数据有争用，产生冲突，再采取其他补偿措施。